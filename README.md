# THU-AISchedule
《小爱课程表》「清华大学-选课系统」导入脚本

## 简介

《[小爱课程表](https://www.ithome.com/0/508/734.htm)》是小米开发的课程表应用。

MIUI 系统自带，具有课程提醒和上课静音的功能，并且支持负一屏、日历订阅。

其他手机到应用商店搜索「小爱课程表」下载即可，相比其他课程表产品有以下优点：更新及时，界面简洁无广告，设置课程便捷，可添加桌面小部件。

此脚本适配选课系统，使用「教务网站导入」，登录后点开课表，点击「一键导入」即可导入。

导入的时间表按照 14 小节配置，可以自行微调课程的小节数。

如果导入失败或者发现 bug 欢迎反馈。（[GitHub Issues](https://github.com/stevenlele/THU-AISchedule/issues) 或 [发邮件](mailto:stevenlele@outlook.com)）

## 可用性

\* 需要使用校园网。

| 设备或系统                   | 「小爱同学」App 可用性            | 「小爱课程表」App 可用性      |
| ---------------------------- | --------------------------------- | ----------------------------- |
| MIUI（小米/红米 Redmi 手机） | ✓（内置，推荐）                   | ✓                             |
| 其他安卓手机                 | ✓                                 | ✓（推荐，功能纯粹，方便使用） |
| iOS/iPadOS                   | ✓（可以在桌面添加小部件方便打开） | ✕（无法自动导入）             |

<!-- - iOS App 上的**本科**选课系统点击「一级课表」「整体课表」没有反应（本应打开新页面），所以没法导入（iOS 14 上测试），已向开发人员反馈 -->
<!-- - 在少数情况下，安卓应用商店上下载的应用里「显示周末」的开关效果是反的 -->

## 致谢

感谢 @TPOB 同学的初版代码以及提供研究生选课系统的信息。

感谢以下同学提供样本：@horseant @gogoduan @十月

## 说明

此脚本是基于选课系统中的「课表」界面编写的，因此无法获得每节课有几小节的信息*，需要导入后手动微调，并且手动在脚本中实现了调课功能。

其他同学开发了一些适用于 THU 的应用，从网络学堂及教学日历接口**获取了每周安排的具体数据，因此时间点更为精细，且自带调课的信息，在「其他推荐」小节中列出。

\* 由于学分与每周课时不完全对应，并且每周 4 课时以上的判断逻辑较为复杂，因此暂未实现。  
\** 由于《小爱课程表》对脚本功能有所限制，因此较难开发网络学堂版的脚本。

## 其他推荐

- [THUInfo](https://github.com/UNIDY2002/THUInfo)——包含时间表功能（[下载](https://github.com/THUInfo/THUInfo)）
- [清华课程小助手](https://github.com/Starrah/THUCourseHelper)——时间表（[下载](https://github.com/Starrah/THUCourseHelper/blob/master/README.md)）
- [learnX](https://github.com/robertying/learnX)——手机版网络学堂，可以将时间表导入日历（[下载](https://learnx.robertying.io/)）
- [Learn Helper](https://github.com/xxr3376/Learn-Project)——网络学堂的浏览器插件（可在 Edge/Firefox 扩展商店下载）
- [thu-learn-lib](https://github.com/Harry-Chen/thu-learn-lib)——供开发者使用的网络学堂 JS 库

## 更新历史

### 19711 (2020-9-24)

- 重写二级课程解析，支持解析更多格式的习题课等，感谢 @十月 同学反馈并提供样本

### 19627 (2020-9-24)

- 支持解析不同时间段上课地点不同，从而在一个格子里有两节课程的情形，感谢 @gogoduan 同学反馈并提供样本
  - 加强了合并课程的判断条件

### 18838 (2020-9-23)

- 新增调课的基本支持，实现自动国庆调课

### 15735 (2020-9-21)

- 参考 THUInfo 将学期周数从 18 改为 16

### 15719 (2020-9-20)

- 细节修改，充分利用 ES6 语法

### 15566 (2020-9-19)

- 支持解析「单周」「双周」课程，感谢 @horseant 同学反馈并提供样本

### 15059 (2020-9-18)

第一版，基于 @TPOB 同学的初版针对研究生选课系统的代码修改而来。

- 简化整理代码结构，修复错误
- 同时支持本科生和研究生选课系统
- 正确获取课程的详细信息，避免课程名中括号的影响
- 改进详细信息解析逻辑，适配缺少课程类型或上课地点的情形
- 支持解析「1-2,5-8」形式的周数
- 尝试支持解析一个格子中有多节课的课表
- 简化合并多个大节同一课程的逻辑（尚不支持一个格子中有多节课）
- 支持解析本科生「整体课表」中游泳测试二级选课的时间、地点、教师
